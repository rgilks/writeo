
> writeo@0.1.0 test
> vitest run

[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚öôÔ∏è  suppress all logs with { quiet: true }
[dotenv@17.2.3] injecting env (4) from .env.local -- tip: ‚öôÔ∏è  write to custom object with { processEnv: myObject }

[1m[46m RUN [49m[22m [36mv4.0.10 [39m[90m/Users/robertgilks/Source/writeo[39m

(node:13026) PromiseRejectionHandledWarning: Promise rejection was handled asynchronously (rejection id: 17)
(Use `node --trace-warnings ...` to show where the warning was created)
(node:13026) PromiseRejectionHandledWarning: Promise rejection was handled asynchronously (rejection id: 27)
(node:13026) PromiseRejectionHandledWarning: Promise rejection was handled asynchronously (rejection id: 24)
[90mstderr[2m | tests/web/error-logger.test.ts[2m > [22m[2mErrorLogger[2m > [22m[2mlogError[2m > [22m[2mshould include environment and timestamp in context
[22m[39mError logged: {
  message: [32m'Test error'[39m,
  stack: [32m'Error: Test error\n'[39m +
    [32m'    at /Users/robertgilks/Source/writeo/tests/web/error-logger.test.ts:90:21\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:157:11\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:753:26\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1636:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1602:10)\n'[39m +
    [32m'    at runTest (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1309:12)\n'[39m +
    [32m'    at async Promise.all (index 1)\n'[39m +
    [32m'    at runSuite (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1457:7)\n'[39m +
    [32m'    at async Promise.all (index 0)'[39m,
  name: [32m'Error'[39m,
  context: {
    userId: [32m'user-123'[39m,
    environment: [32m'development'[39m,
    timestamp: [32m'2025-12-03T07:38:27.126Z'[39m,
    userAgent: [32m'Node.js/24'[39m,
    url: [32m'http://localhost:3000'[39m
  }
}
Error logged: {
  message: [32m'Error 0'[39m,
  stack: [32m'Error: Error 0\n'[39m +
    [32m'    at /Users/robertgilks/Source/writeo/tests/web/error-logger.test.ts:113:30\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:157:11\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:753:26\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1636:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1602:10)\n'[39m +
    [32m'    at runTest (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1309:12)\n'[39m +
    [32m'    at async Promise.all (index 3)\n'[39m +
    [32m'    at runSuite (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1457:7)\n'[39m +
    [32m'    at async Promise.all (index 0)'[39m,
  name: [32m'Error'[39m,
  context: {
    environment: [32m'development'[39m,
    timestamp: [32m'2025-12-03T07:38:27.130Z'[39m,
    userAgent: [32m'Node.js/24'[39m,
    url: [32m'http://localhost:3000'[39m
  }
}
Error logged: {
  message: [32m'Error 1'[39m,
  stack: [32m'Error: Error 1\n'[39m +
    [32m'    at /Users/robertgilks/Source/writeo/tests/web/error-logger.test.ts:113:30\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:157:11\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:753:26\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1636:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1602:10)\n'[39m +
    [32m'    at runTest (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1309:12)\n'[39m +
    [32m'    at async Promise.all (index 3)\n'[39m +
    [32m'    at runSuite (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1457:7)\n'[39m +
    [32m'    at async Promise.all (index 0)'[39m,
  name: [32m'Error'[39m,
  context: {
    environment: [32m'development'[39m,
    timestamp: [32m'2025-12-03T07:38:27.130Z'[39m,
    userAgent: [32m'Node.js/24'[39m,
    url: [32m'http://localhost:3000'[39m
  }
}
Error logged: {
  message: [32m'Error 2'[39m,
  stack: [32m'Error: Error 2\n'[39m +
    [32m'    at /Users/robertgilks/Source/writeo/tests/web/error-logger.test.ts:113:30\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:157:11\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:753:26\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1636:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1602:10)\n'[39m +
    [32m'    at runTest (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1309:12)\n'[39m +
    [32m'    at async Promise.all (index 3)\n'[39m +
    [32m'    at runSuite (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1457:7)\n'[39m +
    [32m'    at async Promise.all (index 0)'[39m,
  name: [32m'Error'[39m,
  context: {
    environment: [32m'development'[39m,
    timestamp: [32m'2025-12-03T07:38:27.130Z'[39m,
    userAgent: [32m'Node.js/24'[39m,
    url: [32m'http://localhost:3000'[39m
  }
}
Error logged: {
  message: [32m'Error 3'[39m,
  stack: [32m'Error: Error 3\n'[39m +
    [32m'    at /Users/robertgilks/Source/writeo/tests/web/error-logger.test.ts:113:30\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:157:11\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:753:26\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1636:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1602:10)\n'[39m +
    [32m'    at runTest (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1309:12)\n'[39m +
    [32m'    at async Promise.all (index 3)\n'[39m +
    [32m'    at runSuite (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1457:7)\n'[39m +
    [32m'    at async Promise.all (index 0)'[39m,
  name: [32m'Error'[39m,
  context: {
    environment: [32m'development'[39m,
    timestamp: [32m'2025-12-03T07:38:27.130Z'[39m,
    userAgent: [32m'Node.js/24'[39m,
    url: [32m'http://localhost:3000'[39m
  }
}
Error logged: {
  message: [32m'Error 4'[39m,
  stack: [32m'Error: Error 4\n'[39m +
    [32m'    at /Users/robertgilks/Source/writeo/tests/web/error-logger.test.ts:113:30\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:157:11\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:753:26\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1636:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1602:10)\n'[39m +
    [32m'    at runTest (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1309:12)\n'[39m +
    [32m'    at async Promise.all (index 3)\n'[39m +
    [32m'    at runSuite (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1457:7)\n'[39m +
    [32m'    at async Promise.all (index 0)'[39m,
  name: [32m'Error'[39m,
  context: {
    environment: [32m'development'[39m,
    timestamp: [32m'2025-12-03T07:38:27.132Z'[39m,
    userAgent: [32m'Node.js/24'[39m,
    url: [32m'http://localhost:3000'[39m
  }
}
Error logged: {
  message: [32m'Error 5'[39m,
  stack: [32m'Error: Error 5\n'[39m +
    [32m'    at /Users/robertgilks/Source/writeo/tests/web/error-logger.test.ts:113:30\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:157:11\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:753:26\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1636:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1602:10)\n'[39m +
    [32m'    at runTest (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1309:12)\n'[39m +
    [32m'    at async Promise.all (index 3)\n'[39m +
    [32m'    at runSuite (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1457:7)\n'[39m +
    [32m'    at async Promise.all (index 0)'[39m,
  name: [32m'Error'[39m,
  context: {
    environment: [32m'development'[39m,
    timestamp: [32m'2025-12-03T07:38:27.132Z'[39m,
    userAgent: [32m'Node.js/24'[39m,
    url: [32m'http://localhost:3000'[39m
  }
}
Error logged: {
  message: [32m'Error 6'[39m,
  stack: [32m'Error: Error 6\n'[39m +
    [32m'    at /Users/robertgilks/Source/writeo/tests/web/error-logger.test.ts:113:30\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:157:11\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:753:26\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1636:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1602:10)\n'[39m +
    [32m'    at runTest (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1309:12)\n'[39m +
    [32m'    at async Promise.all (index 3)\n'[39m +
    [32m'    at runSuite (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1457:7)\n'[39m +
    [32m'    at async Promise.all (index 0)'[39m,
  name: [32m'Error'[39m,
  context: {
    environment: [32m'development'[39m,
    timestamp: [32m'2025-12-03T07:38:27.133Z'[39m,
    userAgent: [32m'Node.js/24'[39m,
    url: [32m'http://localhost:3000'[39m
  }
}
Error logged: {
  message: [32m'Error 7'[39m,
  stack: [32m'Error: Error 7\n'[39m +
    [32m'    at /Users/robertgilks/Source/writeo/tests/web/error-logger.test.ts:113:30\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:157:11\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:753:26\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1636:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1602:10)\n'[39m +
    [32m'    at runTest (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1309:12)\n'[39m +
    [32m'    at async Promise.all (index 3)\n'[39m +
    [32m'    at runSuite (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1457:7)\n'[39m +
    [32m'    at async Promise.all (index 0)'[39m,
  name: [32m'Error'[39m,
  context: {
    environment: [32m'development'[39m,
    timestamp: [32m'2025-12-03T07:38:27.133Z'[39m,
    userAgent: [32m'Node.js/24'[39m,
    url: [32m'http://localhost:3000'[39m
  }
}
Error logged: {
  message: [32m'Error 8'[39m,
  stack: [32m'Error: Error 8\n'[39m +
    [32m'    at /Users/robertgilks/Source/writeo/tests/web/error-logger.test.ts:113:30\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:157:11\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:753:26\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1636:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1602:10)\n'[39m +
    [32m'    at runTest (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1309:12)\n'[39m +
    [32m'    at async Promise.all (index 3)\n'[39m +
    [32m'    at runSuite (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1457:7)\n'[39m +
    [32m'    at async Promise.all (index 0)'[39m,
  name: [32m'Error'[39m,
  context: {
    environment: [32m'development'[39m,
    timestamp: [32m'2025-12-03T07:38:27.134Z'[39m,
    userAgent: [32m'Node.js/24'[39m,
    url: [32m'http://localhost:3000'[39m
  }
}
Error logged: {
  message: [32m'Error 9'[39m,
  stack: [32m'Error: Error 9\n'[39m +
    [32m'    at /Users/robertgilks/Source/writeo/tests/web/error-logger.test.ts:113:30\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:157:11\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:753:26\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1636:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1602:10)\n'[39m +
    [32m'    at runTest (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1309:12)\n'[39m +
    [32m'    at async Promise.all (index 3)\n'[39m +
    [32m'    at runSuite (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1457:7)\n'[39m +
    [32m'    at async Promise.all (index 0)'[39m,
  name: [32m'Error'[39m,
  context: {
    environment: [32m'development'[39m,
    timestamp: [32m'2025-12-03T07:38:27.134Z'[39m,
    userAgent: [32m'Node.js/24'[39m,
    url: [32m'http://localhost:3000'[39m
  }
}
Error logged: {
  message: [32m'Error 10'[39m,
  stack: [32m'Error: Error 10\n'[39m +
    [32m'    at /Users/robertgilks/Source/writeo/tests/web/error-logger.test.ts:113:30\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:157:11\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:753:26\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1636:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1602:10)\n'[39m +
    [32m'    at runTest (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1309:12)\n'[39m +
    [32m'    at async Promise.all (index 3)\n'[39m +
    [32m'    at runSuite (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1457:7)\n'[39m +
    [32m'    at async Promise.all (index 0)'[39m,
  name: [32m'Error'[39m,
  context: {
    environment: [32m'development'[39m,
    timestamp: [32m'2025-12-03T07:38:27.136Z'[39m,
    userAgent: [32m'Node.js/24'[39m,
    url: [32m'http://localhost:3000'[39m
  }
}
Error logged: {
  message: [32m'Error 11'[39m,
  stack: [32m'Error: Error 11\n'[39m +
    [32m'    at /Users/robertgilks/Source/writeo/tests/web/error-logger.test.ts:113:30\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:157:11\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:753:26\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1636:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1602:10)\n'[39m +
    [32m'    at runTest (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1309:12)\n'[39m +
    [32m'    at async Promise.all (index 3)\n'[39m +
    [32m'    at runSuite (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1457:7)\n'[39m +
    [32m'    at async Promise.all (index 0)'[39m,
  name: [32m'Error'[39m,
  context: {
    environment: [32m'development'[39m,
    timestamp: [32m'2025-12-03T07:38:27.142Z'[39m,
    userAgent: [32m'Node.js/24'[39m,
    url: [32m'http://localhost:3000'[39m
  }
}
Error logged: {
  message: [32m'Error 12'[39m,
  stack: [32m'Error: Error 12\n'[39m +
    [32m'    at /Users/robertgilks/Source/writeo/tests/web/error-logger.test.ts:113:30\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:157:11\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:753:26\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1636:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1602:10)\n'[39m +
    [32m'    at runTest (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1309:12)\n'[39m +
    [32m'    at async Promise.all (index 3)\n'[39m +
    [32m'    at runSuite (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1457:7)\n'[39m +
    [32m'    at async Promise.all (index 0)'[39m,
  name: [32m'Error'[39m,
  context: {
    environment: [32m'development'[39m,
    timestamp: [32m'2025-12-03T07:38:27.142Z'[39m,
    userAgent: [32m'Node.js/24'[39m,
    url: [32m'http://localhost:3000'[39m
  }
}
Error logged: {
  message: [32m'Error 13'[39m,
  stack: [32m'Error: Error 13\n'[39m +
    [32m'    at /Users/robertgilks/Source/writeo/tests/web/error-logger.test.ts:113:30\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:157:11\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:753:26\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1636:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1602:10)\n'[39m +
    [32m'    at runTest (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1309:12)\n'[39m +
    [32m'    at async Promise.all (index 3)\n'[39m +
    [32m'    at runSuite (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1457:7)\n'[39m +
    [32m'    at async Promise.all (index 0)'[39m,
  name: [32m'Error'[39m,
  context: {
    environment: [32m'development'[39m,
    timestamp: [32m'2025-12-03T07:38:27.152Z'[39m,
    userAgent: [32m'Node.js/24'[39m,
    url: [32m'http://localhost:3000'[39m
  }
}
Error logged: {
  message: [32m'Error 14'[39m,
  stack: [32m'Error: Error 14\n'[39m +
    [32m'    at /Users/robertgilks/Source/writeo/tests/web/error-logger.test.ts:113:30\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:157:11\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:753:26\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1636:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1602:10)\n'[39m +
    [32m'    at runTest (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1309:12)\n'[39m +
    [32m'    at async Promise.all (index 3)\n'[39m +
    [32m'    at runSuite (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1457:7)\n'[39m +
    [32m'    at async Promise.all (index 0)'[39m,
  name: [32m'Error'[39m,
  context: {
    environment: [32m'development'[39m,
    timestamp: [32m'2025-12-03T07:38:27.152Z'[39m,
    userAgent: [32m'Node.js/24'[39m,
    url: [32m'http://localhost:3000'[39m
  }
}
Error logged: {
  message: [32m'Test'[39m,
  stack: [32m'Error: Test\n'[39m +
    [32m'    at /Users/robertgilks/Source/writeo/tests/web/error-logger.test.ts:122:21\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:157:11\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:753:26\n'[39m +
    [32m'    at file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1636:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1602:10)\n'[39m +
    [32m'    at runTest (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1309:12)\n'[39m +
    [32m'    at async Promise.all (index 4)\n'[39m +
    [32m'    at runSuite (file:///Users/robertgilks/Source/writeo/node_modules/@vitest/runner/dist/index.js:1457:7)\n'[39m +
    [32m'    at async Promise.all (index 0)'[39m,
  name: [32m'Error'[39m,
  context: {
    environment: [32m'development'[39m,
    timestamp: [32m'2025-12-03T07:38:27.155Z'[39m,
    userAgent: [32m'Node.js/24'[39m,
    url: [32m'http://localhost:3000'[39m
  }
}

 [31m‚ùØ[39m tests/api-worker/middleware.request-id.test.ts [2m([22m[2m6 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 39[2mms[22m[39m
     [32m‚úì[39m should generate and set request ID[32m 38[2mms[22m[39m
     [32m‚úì[39m should use first 8 characters of UUID[32m 38[2mms[22m[39m
     [32m‚úì[39m should generate unique request IDs for different requests[32m 38[2mms[22m[39m
[31m     [31m√ó[31m should call next middleware[39m[32m 38[2mms[22m[39m
     [32m‚úì[39m should set request ID before calling next[32m 38[2mms[22m[39m
     [32m‚úì[39m should handle UUID generation edge cases[32m 0[2mms[22m[39m
 [31m‚ùØ[39m tests/web/api-client.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m4 failed[39m[2m)[22m[32m 55[2mms[22m[39m
     [32m‚úì[39m should make GET request with auth header[32m 33[2mms[22m[39m
     [32m‚úì[39m should make POST request with JSON body[32m 33[2mms[22m[39m
     [32m‚úì[39m should use Token prefix for Authorization header[32m 32[2mms[22m[39m
     [32m‚úì[39m should throw error when MISSING_API_KEY is missing[32m 33[2mms[22m[39m
     [32m‚úì[39m should throw error when test-key is missing[32m 33[2mms[22m[39m
[31m     [31m√ó[31m should pass through additional fetch options[39m[32m 17[2mms[22m[39m
[31m     [31m√ó[31m should not include body for GET requests[39m[32m 17[2mms[22m[39m
[31m     [31m√ó[31m should stringify body for POST requests[39m[32m 18[2mms[22m[39m
[31m     [31m√ó[31m should handle undefined body[39m[32m 18[2mms[22m[39m
     [32m‚úì[39m should merge custom headers with default headers[32m 18[2mms[22m[39m
     [32m‚úì[39m should return response from fetch[32m 0[2mms[22m[39m
 [31m‚ùØ[39m tests/web/error-logger.test.ts [2m([22m[2m14 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[32m 88[2mms[22m[39m
       [32m‚úì[39m should log error with context[32m 75[2mms[22m[39m
[31m       [31m√ó[31m should store error in localStorage[39m[32m 74[2mms[22m[39m
       [32m‚úì[39m should convert non-Error to Error[32m 75[2mms[22m[39m
       [32m‚úì[39m should limit stored errors to 10[32m 75[2mms[22m[39m
       [32m‚úì[39m should include environment and timestamp in context[32m 75[2mms[22m[39m
       [32m‚úì[39m should not log when window is undefined[32m 9[2mms[22m[39m
[31m       [31m√ó[31m should log warning with context[39m[32m 9[2mms[22m[39m
[31m       [31m√ó[31m should include context in warning[39m[32m 8[2mms[22m[39m
       [32m‚úì[39m should not log when window is undefined[32m 8[2mms[22m[39m
       [32m‚úì[39m should return stored errors[32m 8[2mms[22m[39m
       [32m‚úì[39m should return empty array when no errors stored[32m 3[2mms[22m[39m
       [32m‚úì[39m should handle invalid JSON gracefully[32m 3[2mms[22m[39m
       [32m‚úì[39m should remove errors from localStorage[32m 3[2mms[22m[39m
       [32m‚úì[39m should handle errors gracefully[32m 3[2mms[22m[39m
[90mstderr[2m | tests/api-worker/middleware.auth.test.ts[2m > [22m[2mauthenticate middleware[2m > [22m[2mreturns 500 if API_KEY is not configured
[22m[39mError checking API key in KV store {}
API_KEY not configured in environment [90mundefined[39m

 [31m‚ùØ[39m tests/api-worker/middleware.auth.test.ts [2m([22m[2m9 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 47[2mms[22m[39m
     [32m‚úì[39m allows public paths without authentication[32m 38[2mms[22m[39m
[31m     [31m√ó[31m rejects requests without Authorization header[39m[32m 38[2mms[22m[39m
     [32m‚úì[39m rejects invalid Authorization header format[32m 38[2mms[22m[39m
     [32m‚úì[39m accepts valid admin API key[32m 38[2mms[22m[39m
     [32m‚úì[39m accepts valid test API key[32m 38[2mms[22m[39m
     [32m‚úì[39m accepts valid user API key from KV store[32m 8[2mms[22m[39m
[31m     [31m√ó[31m rejects invalid API key[39m[32m 8[2mms[22m[39m
     [32m‚úì[39m handles KV store errors gracefully[32m 8[2mms[22m[39m
     [32m‚úì[39m returns 500 if API_KEY is not configured[32m 8[2mms[22m[39m
[90mstderr[2m | tests/api-worker/middleware.rate-limit.test.ts[2m > [22m[2mrateLimit middleware[2m > [22m[2mshould use X-Forwarded-For if CF-Connecting-IP is missing
[22m[39mFailed to parse rate limit data from KV {}
Rate limiting error { message: [32m'KV error'[39m, name: [32m'Error'[39m }

 [31m‚ùØ[39m tests/api-worker/middleware.rate-limit.test.ts [2m([22m[2m16 tests[22m[2m | [22m[31m7 failed[39m[2m)[22m[32m 76[2mms[22m[39m
[31m     [31m√ó[31m should allow public paths without rate limiting[39m[32m 60[2mms[22m[39m
[31m     [31m√ó[31m should allow test keys without rate limiting[39m[32m 59[2mms[22m[39m
     [32m‚úì[39m should allow requests under rate limit[32m 59[2mms[22m[39m
[31m     [31m√ó[31m should reject requests exceeding rate limit[39m[32m 59[2mms[22m[39m
     [32m‚úì[39m should use IP for admin keys[32m 59[2mms[22m[39m
     [32m‚úì[39m should use owner ID for user keys[32m 9[2mms[22m[39m
     [32m‚úì[39m should apply different rate limits for submissions[32m 9[2mms[22m[39m
[31m     [31m√ó[31m should apply different rate limits for results[39m[32m 9[2mms[22m[39m
     [32m‚úì[39m should check daily limit for submissions[32m 5[2mms[22m[39m
     [32m‚úì[39m should reject when daily limit exceeded[32m 4[2mms[22m[39m
[31m     [31m√ó[31m should set rate limit headers[39m[32m 6[2mms[22m[39m
[31m     [31m√ó[31m should reset rate limit after window expires[39m[32m 6[2mms[22m[39m
     [32m‚úì[39m should handle KV store errors gracefully[32m 5[2mms[22m[39m
     [32m‚úì[39m should handle invalid JSON in KV store[32m 6[2mms[22m[39m
[31m     [31m√ó[31m should use X-Forwarded-For if CF-Connecting-IP is missing[39m[32m 5[2mms[22m[39m
     [32m‚úì[39m should use 'unknown' if no IP header is present[32m 0[2mms[22m[39m
 [31m‚ùØ[39m tests/api.test.ts [2m([22m[2m28 tests[22m[2m | [22m[31m26 failed[39m[2m)[22m[32m 179[2mms[22m[39m
[31m     [31m√ó[31m smoke - full E2E workflow[39m[32m 92[2mms[22m[39m
[31m     [31m√ó[31m ai-feedback - AI feedback included in results[39m[32m 69[2mms[22m[39m
[31m     [31m√ó[31m lt - grammar error detection[39m[32m 76[2mms[22m[39m
[31m     [31m√ó[31m lt - confidence scores and tiers[39m[32m 89[2mms[22m[39m
[31m     [31m√ó[31m lt - context-aware tense detection[39m[32m 94[2mms[22m[39m
[31m     [31m√ó[31m llm - assessment integration[39m[32m 31[2mms[22m[39m
[31m     [31m√ó[31m llm - position validation and word boundary alignment[39m[32m 27[2mms[22m[39m
[31m     [31m√ó[31m llm - suggestions match highlighted text[39m[32m 14[2mms[22m[39m
[31m     [31m√ó[31m llm - error positions align with word boundaries[39m[32m 21[2mms[22m[39m
     [32m‚úì[39m modal - health check[32m 1[2mms[22m[39m
[31m     [31m√ó[31m teacher-feedback - persistence and modes[39m[32m 10[2mms[22m[39m
[31m     [31m√ó[31m streaming - AI feedback stream[39m[32m 10[2mms[22m[39m
[31m     [31m√ó[31m timing - performance check[39m[32m 8[2mms[22m[39m
[31m     [31m√ó[31m timing - processing time tracking[39m[32m 8[2mms[22m[39m
     [32m‚úì[39m error handling - retry logic on 5xx errors[32m 8[2mms[22m[39m
[31m     [31m√ó[31m validation - invalid UUID format[39m[32m 7[2mms[22m[39m
[31m     [31m√ó[31m validation - missing required fields[39m[32m 7[2mms[22m[39m
[31m     [31m√ó[31m validation - word count minimum (frontend)[39m[32m 7[2mms[22m[39m
[31m     [31m√ó[31m validation - word count maximum (frontend)[39m[32m 6[2mms[22m[39m
[31m     [31m√ó[31m validation - missing answer text returns error[39m[32m 6[2mms[22m[39m
[31m     [31m√ó[31m auto-creation - questions and answers created automatically[39m[32m 3[2mms[22m[39m
[31m     [31m√ó[31m compat - uses 'text' field[39m[32m 16[2mms[22m[39m
[31m     [31m√ó[31m compat - accepts user and type fields (ignored)[39m[32m 54[2mms[22m[39m
[31m     [31m√ó[31m compat - supports bypass-submission-processing query param[39m[32m 54[2mms[22m[39m
[31m     [31m√ó[31m synchronous - results returned immediately in response[39m[32m 55[2mms[22m[39m
[31m     [31m√ó[31m relevance - answer relevance check[39m[32m 55[2mms[22m[39m
[31m     [31m√ó[31m cost-controls - essay truncation for long essays[39m[32m 41[2mms[22m[39m
[31m     [31m√ó[31m teacher-feedback - includes all assessment sources[39m[32m 6[2mms[22m[39m
 [31m‚ùØ[39m tests/api-worker/utils.fetch-with-timeout.test.ts [2m([22m[2m10 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 25[2mms[22m[39m
     [32m‚úì[39m should make fetch request successfully[32m 20[2mms[22m[39m
     [32m‚úì[39m should use default timeout of 30000ms[32m 20[2mms[22m[39m
     [32m‚úì[39m should use custom timeout when provided[32m 20[2mms[22m[39m
     [32m‚úì[39m should timeout and throw error when timeout is exceeded[32m 20[2mms[22m[39m
     [32m‚úì[39m should include URL in timeout error message[32m 20[2mms[22m[39m
     [32m‚úì[39m should pass through fetch options[32m 4[2mms[22m[39m
     [32m‚úì[39m should clear timeout on successful request[32m 4[2mms[22m[39m
[31m     [31m√ó[31m should clear timeout on error[39m[32m 4[2mms[22m[39m
     [32m‚úì[39m should propagate non-timeout errors[32m 3[2mms[22m[39m
     [32m‚úì[39m should handle abort signal correctly[32m 3[2mms[22m[39m
 [31m‚ùØ[39m tests/web/submission.test.ts [2m([22m[2m8 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 9[2mms[22m[39m
       [32m‚úì[39m should return results unchanged when window is undefined[32m 8[2mms[22m[39m
       [32m‚úì[39m should return results unchanged when questionText is empty[32m 8[2mms[22m[39m
       [32m‚úì[39m should return results unchanged when no answerTexts in meta[32m 8[2mms[22m[39m
[31m       [31m√ó[31m should create questionTexts when it doesn't exist[39m[32m 8[2mms[22m[39m
[31m       [31m√ó[31m should add questionText to existing questionTexts[39m[32m 8[2mms[22m[39m
       [32m‚úì[39m should not overwrite existing questionText for same answerId[32m 1[2mms[22m[39m
       [32m‚úì[39m should handle multiple answerIds and only add questionText for first one[32m 1[2mms[22m[39m
       [32m‚úì[39m should preserve all other meta properties[32m 1[2mms[22m[39m
[90mstdout[2m | tests/web/storage.test.ts[2m > [22m[2mcleanupExpiredStorage[2m > [22m[2mshould handle invalid JSON gracefully
[22m[39mCleaned up 1 expired storage entries
Cleaned up 1 expired storage entries

[90mstdout[2m | tests/web/storage.test.ts
[22m[39mCleaned up 1 expired storage entries

[90mstderr[2m | tests/web/storage.test.ts
[22m[39mCorrupted storage data detected for test, clearing it

[90mstderr[2m | tests/web/storage.test.ts[2m > [22m[2mcreateSafeStorage[2m > [22m[2msetItem[2m > [22m[2mshould warn when window is undefined
[22m[39mFailed to get item test from localStorage: Error: Storage error
    at Object.<anonymous> [90m(/Users/robertgilks/Source/writeo/[39mtests/web/storage.test.ts:137:15[90m)[39m
    at Object.Mock [as getItem] [90m(file:///Users/robertgilks/Source/writeo/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:280:34[90m)[39m
    at Object.getItem [90m(/Users/robertgilks/Source/writeo/[39mapps/web/app/lib/utils/storage.ts:74:36[90m)[39m
    at [90m/Users/robertgilks/Source/writeo/[39mtests/web/storage.test.ts:141:30
    at [90mfile:///Users/robertgilks/Source/writeo/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:157:11
    at [90mfile:///Users/robertgilks/Source/writeo/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:753:26
    at [90mfile:///Users/robertgilks/Source/writeo/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1636:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/robertgilks/Source/writeo/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1602:10[90m)[39m
    at runTest [90m(file:///Users/robertgilks/Source/writeo/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1309:12[90m)[39m

[90mstdout[2m | tests/web/storage.test.ts[2m > [22m[2mcreateSafeStorage[2m > [22m[2mremoveItem[2m > [22m[2mshould remove item successfully
[22m[39mCleaned up 1 old results entries

[90mstderr[2m | tests/web/storage.test.ts[2m > [22m[2mcreateSafeStorage[2m > [22m[2mremoveItem[2m > [22m[2mshould remove item successfully
[22m[39mStorage quota exceeded for test: [DOMException [QuotaExceededError]: Quota exceeded]

 [31m‚ùØ[39m tests/api-worker/middleware.security.test.ts [2m([22m[2m14 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 21[2mms[22m[39m
     [32m‚úì[39m should add security headers to response[32m 20[2mms[22m[39m
[31m     [31m√ó[31m should call next middleware[39m[32m 20[2mms[22m[39m
     [32m‚úì[39m should add headers after next is called[32m 20[2mms[22m[39m
     [32m‚úì[39m should add all required security headers[32m 20[2mms[22m[39m
     [32m‚úì[39m should handle CORS origin: origin=https://example.com, allowedOrigins=undefined[32m 20[2mms[22m[39m
     [32m‚úì[39m should handle CORS origin: origin=null, allowedOrigins=undefined[32m 0[2mms[22m[39m
     [32m‚úì[39m should handle CORS origin: origin=https://example.com, allowedOrigins=https://example.com,https://other.com[32m 0[2mms[22m[39m
     [32m‚úì[39m should handle CORS origin: origin=https://evil.com, allowedOrigins=https://example.com,https://other.com[32m 0[2mms[22m[39m
     [32m‚úì[39m should handle CORS origin: origin=https://example.com, allowedOrigins=https://example.com, https://other.com[32m 0[2mms[22m[39m
     [32m‚úì[39m should trim whitespace from allowed origins[32m 0[2mms[22m[39m
     [32m‚úì[39m should be case-sensitive for origin matching[32m 0[2mms[22m[39m
     [32m‚úì[39m should handle edge cases: origin=, allowedOrigins=https://example.com, expected=[32m 0[2mms[22m[39m
     [32m‚úì[39m should handle edge cases: origin=https://example.com, allowedOrigins=https://example.com, expected=https://example.com[32m 0[2mms[22m[39m
     [32m‚úì[39m should handle edge cases: origin=https://example.com, allowedOrigins=, expected=https://example.com[32m 0[2mms[22m[39m
 [31m‚ùØ[39m tests/web/storage.test.ts [2m([22m[2m25 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[32m 26[2mms[22m[39m
     [32m‚úì[39m should return null when window is undefined[32m 4[2mms[22m[39m
     [32m‚úì[39m should return estimated storage space when window is available[32m 3[2mms[22m[39m
       [32m‚úì[39m should return null when window is undefined[32m 1[2mms[22m[39m
       [32m‚úì[39m should return stored value[32m 1[2mms[22m[39m
       [32m‚úì[39m should return null for non-existent key[32m 1[2mms[22m[39m
       [32m‚úì[39m should detect and remove corrupted data[32m 1[2mms[22m[39m
       [32m‚úì[39m should handle localStorage errors gracefully[32m 10[2mms[22m[39m
[31m       [31m√ó[31m should store value successfully[39m[32m 5[2mms[22m[39m
       [32m‚úì[39m should warn when window is undefined[32m 5[2mms[22m[39m
[31m       [31m√ó[31m should throw StorageError on quota exceeded[39m[32m 3[2mms[22m[39m
[31m       [31m√ó[31m should throw StorageError on security error[39m[32m 3[2mms[22m[39m
       [32m‚úì[39m should retry after cleanup on quota error[32m 10[2mms[22m[39m
       [32m‚úì[39m should warn about large values[32m 9[2mms[22m[39m
       [32m‚úì[39m should remove item successfully[32m 9[2mms[22m[39m
       [32m‚úì[39m should handle errors gracefully[32m 9[2mms[22m[39m
       [32m‚úì[39m should return early when window is undefined[32m 9[2mms[22m[39m
     [32m‚úì[39m should cleanup expired entries[32m 3[2mms[22m[39m
     [32m‚úì[39m should only cleanup results_ keys[32m 3[2mms[22m[39m
     [32m‚úì[39m should handle invalid JSON gracefully[32m 3[2mms[22m[39m
     [32m‚úì[39m should handle entries without timestamp[32m 2[2mms[22m[39m
     [32m‚úì[39m should return early when window is undefined[32m 2[2mms[22m[39m
     [32m‚úì[39m should use default maxAge of 30 days[32m 1[2mms[22m[39m
     [32m‚úì[39m should handle errors during cleanup[32m 1[2mms[22m[39m
     [32m‚úì[39m should create error with code[32m 1[2mms[22m[39m
     [32m‚úì[39m should support all error codes[32m 1[2mms[22m[39m
 [32m‚úì[39m tests/web/error-handling.test.ts [2m([22m[2m24 tests[22m[2m)[22m[32m 20[2mms[22m[39m
 [32m‚úì[39m tests/api-worker/utils.http.test.ts [2m([22m[2m12 tests[22m[2m)[22m[32m 21[2mms[22m[39m
 [32m‚úì[39m tests/api-worker/utils.errors.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 45[2mms[22m[39m
 [32m‚úì[39m tests/web/progress.test.ts [2m([22m[2m24 tests[22m[2m)[22m[32m 102[2mms[22m[39m
 [32m‚úì[39m tests/position-validation.test.ts [2m([22m[2m10 tests[22m[2m)[22m[32m 7[2mms[22m[39m
 [32m‚úì[39m tests/api-worker/utils.context.test.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 29[2mms[22m[39m
 [32m‚úì[39m tests/web/error-utils.test.ts [2m([22m[2m21 tests[22m[2m)[22m[32m 4[2mms[22m[39m
 [32m‚úì[39m tests/web/grammar-rules.test.ts [2m([22m[2m25 tests[22m[2m)[22m[32m 13[2mms[22m[39m
 [32m‚úì[39m tests/api-worker/utils.validation.test.ts [2m([22m[2m16 tests[22m[2m)[22m[32m 24[2mms[22m[39m
 [32m‚úì[39m tests/shared/types.test.ts [2m([22m[2m30 tests[22m[2m)[22m[32m 10[2mms[22m[39m
 [32m‚úì[39m tests/api-worker/utils.zod.test.ts [2m([22m[2m15 tests[22m[2m)[22m[32m 52[2mms[22m[39m
 [32m‚úì[39m tests/web/uuid-utils.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 4[2mms[22m[39m
 [32m‚úì[39m tests/web/learner-results-utils.test.ts [2m([22m[2m27 tests[22m[2m)[22m[32m 7[2mms[22m[39m
 [32m‚úì[39m tests/web/text-utils.test.ts [2m([22m[2m21 tests[22m[2m)[22m[32m 3[2mms[22m[39m
 [32m‚úì[39m tests/web/validation.test.ts [2m([22m[2m22 tests[22m[2m)[22m[32m 5[2mms[22m[39m
 [32m‚úì[39m tests/web/error-messages.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 4[2mms[22m[39m
 [32m‚úì[39m tests/web/error-formatting.test.ts [2m([22m[2m13 tests[22m[2m)[22m[32m 6[2mms[22m[39m
 [32m‚úì[39m tests/web/pwa.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 2[2mms[22m[39m
 [32m‚úì[39m tests/shared/validation.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 2[2mms[22m[39m
 [32m‚úì[39m tests/shared/text-utils.test.ts [2m([22m[2m20 tests[22m[2m)[22m[32m 3[2mms[22m[39m
 [32m‚úì[39m tests/api-worker/integration.middleware.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 1[2mms[22m[39m
 [31m‚ùØ[39m tests/shared/retry.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m10 failed[39m[2m)[22m[33m 30006[2mms[22m[39m
     [32m‚úì[39m should succeed on first attempt[32m 5[2mms[22m[39m
[31m     [31m√ó[31m should retry on failure and succeed[39m[32m 12[2mms[22m[39m
[31m     [31m√ó[31m should retry up to maxAttempts times[39m[32m 13[2mms[22m[39m
[31m     [31m√ó[31m should use exponential backoff[39m[32m 14[2mms[22m[39m
[31m     [31m√ó[31m should respect maxDelayMs[39m[33m 30005[2mms[22m[39m
     [32m‚úì[39m should not retry if shouldRetry returns false[32m 2[2mms[22m[39m
[31m     [31m√ó[31m should retry if shouldRetry returns true[39m[32m 9[2mms[22m[39m
     [32m‚úì[39m should use default shouldRetry to skip 4xx errors[32m 0[2mms[22m[39m
[31m     [31m√ó[31m should retry non-4xx errors by default[39m[32m 3[2mms[22m[39m
[31m     [31m√ó[31m should handle errors that are not Error instances[39m[32m 4[2mms[22m[39m
[31m     [31m√ó[31m should use default maxAttempts of 3[39m[32m 5[2mms[22m[39m
     [32m‚úì[39m should use default baseDelayMs of 500[32m 4[2mms[22m[39m
[31m     [31m√ó[31m should throw last error after all retries exhausted[39m[32m 5[2mms[22m[39m
[31m     [31m√ó[31m should handle promise rejection correctly[39m[32m 4[2mms[22m[39m
     [32m‚úì[39m should work with async functions[32m 3[2mms[22m[39m
 [32m‚úì[39m tests/api-worker/services.llm-mock.test.ts [2m([22m[2m10 tests[22m[2m)[22m[33m 35009[2mms[22m[39m
     [33m[2m‚úì[22m[39m should handle timeout error scenario [33m 35007[2mms[22m[39m
     [33m[2m‚úì[22m[39m should handle streaming errors [33m 35004[2mms[22m[39m

[31m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[39m[1m[41m Failed Tests 60 [49m[22m[31m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22msmoke - full E2E workflow
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m21:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[1/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mai-feedback - AI feedback included in results
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m49:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[2/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mlt - grammar error detection
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m77:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[3/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mlt - confidence scores and tiers
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m109:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[4/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mlt - context-aware tense detection
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m163:46[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[5/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mllm - assessment integration
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m239:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[6/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mllm - position validation and word boundary alignment
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m315:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[7/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mllm - suggestions match highlighted text
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m393:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[8/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mllm - error positions align with word boundaries
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m450:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[9/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mteacher-feedback - persistence and modes
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m535:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[10/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mstreaming - AI feedback stream
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m628:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[11/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mtiming - performance check
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m732:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[12/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mtiming - processing time tracking
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m761:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[13/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mvalidation - invalid UUID format
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m812:24[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[14/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mvalidation - missing required fields
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m820:24[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[15/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mvalidation - word count minimum (frontend)
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m833:24[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[16/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mvalidation - word count maximum (frontend)
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m864:24[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[17/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mvalidation - missing answer text returns error
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m888:24[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[18/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mauto-creation - questions and answers created automatically
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m914:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[19/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mcompat - uses 'text' field
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m944:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[20/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mcompat - accepts user and type fields (ignored)
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m970:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[21/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mcompat - supports bypass-submission-processing query param
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m1005:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22msynchronous - results returned immediately in response
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m1040:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[23/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mrelevance - answer relevance check
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m1074:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[24/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mcost-controls - essay truncation for long essays
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m1123:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[25/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api.test.ts[2m > [22mAPI Tests[2m > [22mteacher-feedback - includes all assessment sources
[31m[1mTypeError[22m: fetch failed[39m
[36m [2m‚ùØ[22m apiRequest tests/helpers.ts:[2m26:20[22m[39m
    [90m 24| [39m
    [90m 25| [39mexport async function apiRequest(method: string, path: string, body?: ‚Ä¶
    [90m 26| [39m  [35mconst[39m response [33m=[39m [35mawait[39m [34mfetch[39m([32m`[39m[36m${[39m[33mAPI_BASE[39m[36m}[39m[32m[39m[36m${[39mpath[36m}[39m[32m`[39m[33m,[39m {
    [90m   | [39m                   [31m^[39m
    [90m 27| [39m    method[33m,[39m
    [90m 28| [39m    headers[33m:[39m {
[90m [2m‚ùØ[22m tests/api.test.ts:[2m1182:30[22m[39m

{
  stack: 'AggregateError: \n' +
    '    at internalConnectMultiple (node:net:1134:18)\n' +
    '    at afterConnectMultiple (node:net:1715:7)',
  errors: [
    {
      stack: 'Error: connect ECONNREFUSED ::1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED ::1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '::1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    },
    {
      stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n' +
        '    at createConnectionError (node:net:1678:14)\n' +
        '    at afterConnectMultiple (node:net:1708:16)',
      message: 'connect ECONNREFUSED 127.0.0.1:8787',
      errno: -61,
      code: 'ECONNREFUSED',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 8787,
      constructor: 'Function<Error>',
      name: 'Error',
      toString: 'Function<toString>'
    }
  ],
  code: 'ECONNREFUSED',
  constructor: 'Function<AggregateError>',
  name: 'Caused by: AggregateError',
  message: '',
  toString: 'Function<toString>',
  stacks: []
}
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[22m[39m
[31m[1mSerialized Error:[22m[39m [90m{ errors: [ { stack: 'Error: connect ECONNREFUSED ::1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED ::1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '::1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' }, { stack: 'Error: connect ECONNREFUSED 127.0.0.1:8787\n    at createConnectionError (node:net:1678:14)\n    at afterConnectMultiple (node:net:1708:16)', message: 'connect ECONNREFUSED 127.0.0.1:8787', errno: -61, code: 'ECONNREFUSED', syscall: 'connect', address: '127.0.0.1', port: 8787, constructor: 'Function<Error>', name: 'Error', toString: 'Function<toString>' } ], code: 'ECONNREFUSED' }[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[26/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api-worker/middleware.auth.test.ts[2m > [22mauthenticate middleware[2m > [22mrejects requests without Authorization header
[31m[1mAssertionError[22m: expected "vi.fn()" to not be called at all, but actually been called 1 times[90m

Received: 

[1m  1st vi.fn() call:

[22m    Array []
[31m[90m

Number of calls: [1m1[22m
[31m[39m
[36m [2m‚ùØ[22m tests/api-worker/middleware.auth.test.ts:[2m34:26[22m[39m
    [90m 32| [39m    [34mexpect[39m(result)[33m.[39m[34mtoBeInstanceOf[39m([33mResponse[39m)[33m;[39m
    [90m 33| [39m    [34mexpect[39m((result [35mas[39m [33mResponse[39m)[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m401[39m)[33m;[39m
    [90m 34| [39m    [34mexpect[39m(mockNext)[33m.[39mnot[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m   | [39m                         [31m^[39m
    [90m 35| [39m  })[33m;[39m
    [90m 36| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[27/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api-worker/middleware.auth.test.ts[2m > [22mauthenticate middleware[2m > [22mrejects invalid API key
[31m[1mAssertionError[22m: expected "vi.fn()" to not be called at all, but actually been called 1 times[90m

Received: 

[1m  1st vi.fn() call:

[22m    Array []
[31m[90m

Number of calls: [1m1[22m
[31m[39m
[36m [2m‚ùØ[22m tests/api-worker/middleware.auth.test.ts:[2m95:26[22m[39m
    [90m 93| [39m    [34mexpect[39m(result)[33m.[39m[34mtoBeInstanceOf[39m([33mResponse[39m)[33m;[39m
    [90m 94| [39m    [34mexpect[39m((result [35mas[39m [33mResponse[39m)[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m401[39m)[33m;[39m
    [90m 95| [39m    [34mexpect[39m(mockNext)[33m.[39mnot[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m   | [39m                         [31m^[39m
    [90m 96| [39m  })[33m;[39m
    [90m 97| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[28/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api-worker/middleware.rate-limit.test.ts[2m > [22mrateLimit middleware[2m > [22mshould allow public paths without rate limiting
[31m[1mAssertionError[22m: expected "vi.fn()" to not be called at all, but actually been called 3 times[90m

Received: 

[1m  1st vi.fn() call:

[22m    Array [
      "rate_limit:prod:general:192.168.1.1",
    ]

[1m  2nd vi.fn() call:

[22m    Array [
      "rate_limit:prod:submissions:192.168.1.1",
    ]

[1m  3rd vi.fn() call:

[22m    Array [
      "rate_limit:prod:general:192.168.1.1",
    ]
[31m[90m

Number of calls: [1m3[22m
[31m[39m
[36m [2m‚ùØ[22m tests/api-worker/middleware.rate-limit.test.ts:[2m35:33[22m[39m
    [90m 33| [39m    [34mexpect[39m(mockNext)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m 34| [39m    [90m// Public paths should return early, so KV should not be accessed[39m
    [90m 35| [39m    [34mexpect[39m(mockKvStore[33m.[39m[35mget[39m)[33m.[39mnot[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m 36| [39m    [34mexpect[39m(mockKvStore[33m.[39mput)[33m.[39mnot[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m 37| [39m  })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[29/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api-worker/middleware.rate-limit.test.ts[2m > [22mrateLimit middleware[2m > [22mshould allow test keys without rate limiting
[31m[1mAssertionError[22m: expected "vi.fn()" to not be called at all, but actually been called 3 times[90m

Received: 

[1m  1st vi.fn() call:

[22m    Array [
      "rate_limit:prod:general:192.168.1.1",
    ]

[1m  2nd vi.fn() call:

[22m    Array [
      "rate_limit:prod:submissions:192.168.1.1",
    ]

[1m  3rd vi.fn() call:

[22m    Array [
      "rate_limit:prod:general:192.168.1.1",
    ]
[31m[90m

Number of calls: [1m3[22m
[31m[39m
[36m [2m‚ùØ[22m tests/api-worker/middleware.rate-limit.test.ts:[2m51:33[22m[39m
    [90m 49| [39m    [34mexpect[39m(mockNext)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m 50| [39m    [90m// Test keys should return early, so KV should not be accessed[39m
    [90m 51| [39m    [34mexpect[39m(mockKvStore[33m.[39m[35mget[39m)[33m.[39mnot[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m   | [39m                                [31m^[39m
    [90m 52| [39m    [34mexpect[39m(mockKvStore[33m.[39mput)[33m.[39mnot[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m 53| [39m  })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[30/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api-worker/middleware.rate-limit.test.ts[2m > [22mrateLimit middleware[2m > [22mshould reject requests exceeding rate limit
[31m[1mAssertionError[22m: expected "vi.fn()" to not be called at all, but actually been called 2 times[90m

Received: 

[1m  1st vi.fn() call:

[22m    Array []

[1m  2nd vi.fn() call:

[22m    Array []
[31m[90m

Number of calls: [1m2[22m
[31m[39m
[36m [2m‚ùØ[22m tests/api-worker/middleware.rate-limit.test.ts:[2m90:26[22m[39m
    [90m 88| [39m    [34mexpect[39m(result)[33m.[39m[34mtoBeInstanceOf[39m([33mResponse[39m)[33m;[39m
    [90m 89| [39m    [34mexpect[39m((result [35mas[39m [33mResponse[39m)[33m.[39mstatus)[33m.[39m[34mtoBe[39m([34m429[39m)[33m;[39m
    [90m 90| [39m    [34mexpect[39m(mockNext)[33m.[39mnot[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m   | [39m                         [31m^[39m
    [90m 91| [39m  })[33m;[39m
    [90m 92| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[31/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api-worker/middleware.rate-limit.test.ts[2m > [22mrateLimit middleware[2m > [22mshould apply different rate limits for results
[31m[1mAssertionError[22m: expected 'rate_limit:prod:general:user-123' to contain 'results'[39m

Expected: [32m"r[7mesults[27m"[39m
Received: [31m"r[7mate_limit:prod:general:user-123[27m"[39m

[36m [2m‚ùØ[22m tests/api-worker/middleware.rate-limit.test.ts:[2m179:24[22m[39m
    [90m177| [39m    [90m// Results endpoint has higher limit (60)[39m
    [90m178| [39m    [35mconst[39m putCall [33m=[39m mockKvStore[33m.[39mput[33m.[39mmock[33m.[39mcalls[[34m0[39m][33m;[39m
    [90m179| [39m    [34mexpect[39m(putCall[[34m0[39m])[33m.[39m[34mtoContain[39m([32m"results"[39m)[33m;[39m
    [90m   | [39m                       [31m^[39m
    [90m180| [39m  })[33m;[39m
    [90m181| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[32/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api-worker/middleware.rate-limit.test.ts[2m > [22mrateLimit middleware[2m > [22mshould set rate limit headers
[31m[1mAssertionError[22m: expected "vi.fn()" to be called with arguments: [ 'X-RateLimit-Limit', Any<String> ][90m

Number of calls: [1m0[22m
[31m[39m
[36m [2m‚ùØ[22m tests/api-worker/middleware.rate-limit.test.ts:[2m246:22[22m[39m
    [90m244| [39m
    [90m245| [39m    [90m// Check that headers were set[39m
    [90m246| [39m    expect(c.header).toHaveBeenCalledWith("X-RateLimit-Limit", expect.‚Ä¶
    [90m   | [39m                     [31m^[39m
    [90m247| [39m    expect(c.header).toHaveBeenCalledWith("X-RateLimit-Remaining", exp‚Ä¶
    [90m248| [39m    expect(c.header).toHaveBeenCalledWith("X-RateLimit-Reset", expect.‚Ä¶

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[33/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api-worker/middleware.rate-limit.test.ts[2m > [22mrateLimit middleware[2m > [22mshould reset rate limit after window expires
[31m[1mAssertionError[22m: expected 0 to be greater than 0[39m
[36m [2m‚ùØ[22m tests/api-worker/middleware.rate-limit.test.ts:[2m271:29[22m[39m
    [90m269| [39m    [90m// Then updateRateLimitState increments it to 1[39m
    [90m270| [39m    [35mconst[39m putCalls [33m=[39m mockKvStore[33m.[39mput[33m.[39mmock[33m.[39mcalls[33m;[39m
    [90m271| [39m    [34mexpect[39m(putCalls[33m.[39mlength)[33m.[39m[34mtoBeGreaterThan[39m([34m0[39m)[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m272| [39m
    [90m273| [39m    // Find the call that contains valid JSON (skip any that might be ‚Ä¶

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[34/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api-worker/middleware.rate-limit.test.ts[2m > [22mrateLimit middleware[2m > [22mshould use X-Forwarded-For if CF-Connecting-IP is missing
[31m[1mAssertionError[22m: expected 'rate_limit:prod:general:192.168.1.1' to contain '10.0.0.1'[39m

Expected: [32m"[7m10.0.0[27m.1"[39m
Received: [31m"[7mrate_limit:prod:general:192.168.1[27m.1"[39m

[36m [2m‚ùØ[22m tests/api-worker/middleware.rate-limit.test.ts:[2m342:24[22m[39m
    [90m340| [39m
    [90m341| [39m    [35mconst[39m putCall [33m=[39m mockKvStore[33m.[39mput[33m.[39mmock[33m.[39mcalls[[34m0[39m][33m;[39m
    [90m342| [39m    [34mexpect[39m(putCall[[34m0[39m])[33m.[39m[34mtoContain[39m([32m"10.0.0.1"[39m)[33m;[39m
    [90m   | [39m                       [31m^[39m
    [90m343| [39m  })[33m;[39m
    [90m344| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[35/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api-worker/middleware.request-id.test.ts[2m > [22mrequestId middleware[2m > [22mshould call next middleware
[31m[1mAssertionError[22m: expected "vi.fn()" to be called 1 times, but got 6 times[39m
[36m [2m‚ùØ[22m tests/api-worker/middleware.request-id.test.ts:[2m79:22[22m[39m
    [90m 77| [39m    [35mawait[39m [34mrequestId[39m(c[33m,[39m mockNext)[33m;[39m
    [90m 78| [39m
    [90m 79| [39m    [34mexpect[39m(mockNext)[33m.[39m[34mtoHaveBeenCalledTimes[39m([34m1[39m)[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m 80| [39m  })[33m;[39m
    [90m 81| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[36/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api-worker/middleware.security.test.ts[2m > [22msecurityHeaders middleware[2m > [22mshould call next middleware
[31m[1mAssertionError[22m: expected "vi.fn()" to be called 1 times, but got 4 times[39m
[36m [2m‚ùØ[22m tests/api-worker/middleware.security.test.ts:[2m30:22[22m[39m
    [90m 28| [39m    [35mawait[39m [34msecurityHeaders[39m(c[33m,[39m mockNext)[33m;[39m
    [90m 29| [39m
    [90m 30| [39m    [34mexpect[39m(mockNext)[33m.[39m[34mtoHaveBeenCalledTimes[39m([34m1[39m)[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m 31| [39m  })[33m;[39m
    [90m 32| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[37/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/api-worker/utils.fetch-with-timeout.test.ts[2m > [22mfetchWithTimeout[2m > [22mshould clear timeout on error
[31m[1mAssertionError[22m: expected "clearTimeout" to be called at least once[39m
[36m [2m‚ùØ[22m tests/api-worker/utils.fetch-with-timeout.test.ts:[2m172:29[22m[39m
    [90m170| [39m    }
    [90m171| [39m
    [90m172| [39m    [34mexpect[39m(clearTimeoutSpy)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m173| [39m    clearTimeoutSpy[33m.[39m[34mmockRestore[39m()[33m;[39m
    [90m174| [39m  })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[38/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/web/api-client.test.ts[2m > [22mapiRequest[2m > [22mshould pass through additional fetch options
[31m[1mAssertionError[22m: expected "vi.fn()" to be called at least once[39m
[36m [2m‚ùØ[22m tests/web/api-client.test.ts:[2m104:23[22m[39m
    [90m102| [39m    })[33m;[39m
    [90m103| [39m
    [90m104| [39m    [34mexpect[39m(mockFetch)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m   | [39m                      [31m^[39m
    [90m105| [39m    [35mconst[39m fetchCall [33m=[39m mockFetch[33m.[39mmock[33m.[39mcalls[[34m0[39m][33m;[39m
    [90m106| [39m    [34mexpect[39m(fetchCall[[34m1[39m][33m.[39mcache)[33m.[39m[34mtoBe[39m([32m"no-cache"[39m)[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[39/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/web/api-client.test.ts[2m > [22mapiRequest[2m > [22mshould not include body for GET requests
[31m[1mTypeError[22m: Cannot read properties of undefined (reading '1')[39m
[36m [2m‚ùØ[22m tests/web/api-client.test.ts:[2m123:12[22m[39m
    [90m121| [39m
    [90m122| [39m    [35mconst[39m fetchCall [33m=[39m mockFetch[33m.[39mmock[33m.[39mcalls[[34m0[39m][33m;[39m
    [90m123| [39m    [34mexpect[39m(fetchCall[[34m1[39m][33m.[39mbody)[33m.[39m[34mtoBeUndefined[39m()[33m;[39m
    [90m   | [39m           [31m^[39m
    [90m124| [39m  })[33m;[39m
    [90m125| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[40/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/web/api-client.test.ts[2m > [22mapiRequest[2m > [22mshould stringify body for POST requests
[31m[1mAssertionError[22m: expected "vi.fn()" to be called with arguments: [ Array(2) ][90m

Number of calls: [1m0[22m
[31m[39m
[36m [2m‚ùØ[22m tests/web/api-client.test.ts:[2m137:23[22m[39m
    [90m135| [39m    [35mawait[39m [34mapiRequest[39m({ endpoint[33m:[39m [32m"/test"[39m[33m,[39m method[33m:[39m [32m"POST"[39m[33m,[39m body })[33m;[39m
    [90m136| [39m
    [90m137| [39m    [34mexpect[39m(mockFetch)[33m.[39m[34mtoHaveBeenCalledWith[39m(
    [90m   | [39m                      [31m^[39m
    [90m138| [39m      [32m"https://api.example.com/test"[39m[33m,[39m
    [90m139| [39m      expect[33m.[39m[34mobjectContaining[39m({

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[41/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/web/api-client.test.ts[2m > [22mapiRequest[2m > [22mshould handle undefined body
[31m[1mAssertionError[22m: expected "vi.fn()" to be called at least once[39m
[36m [2m‚ùØ[22m tests/web/api-client.test.ts:[2m155:23[22m[39m
    [90m153| [39m    await apiRequest({ endpoint: "/test", method: "GET", body: undefin‚Ä¶
    [90m154| [39m
    [90m155| [39m    [34mexpect[39m(mockFetch)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m   | [39m                      [31m^[39m
    [90m156| [39m    [35mconst[39m fetchCall [33m=[39m mockFetch[33m.[39mmock[33m.[39mcalls[[34m0[39m][33m;[39m
    [90m157| [39m    [34mexpect[39m(fetchCall)[33m.[39m[34mtoBeDefined[39m()[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[42/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/web/error-logger.test.ts[2m > [22mErrorLogger[2m > [22mlogError[2m > [22mshould store error in localStorage
[31m[1mAssertionError[22m: expected [ ‚Ä¶(2) ] to have a length of 1 but got 2[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 1[39m
[31m+ 2[39m

[36m [2m‚ùØ[22m tests/web/error-logger.test.ts:[2m96:22[22m[39m
    [90m 94| [39m
    [90m 95| [39m      [35mconst[39m stored [33m=[39m [33mJSON[39m[33m.[39m[34mparse[39m(mockLocalStorage[[32m"writeo_errors"[39m])[33m;[39m
    [90m 96| [39m      [34mexpect[39m(stored)[33m.[39m[34mtoHaveLength[39m([34m1[39m)[33m;[39m
    [90m   | [39m                     [31m^[39m
    [90m 97| [39m      [34mexpect[39m(stored[[34m0[39m][33m.[39mmessage)[33m.[39m[34mtoBe[39m([32m"Test error"[39m)[33m;[39m
    [90m 98| [39m    })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[43/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/web/error-logger.test.ts[2m > [22mErrorLogger[2m > [22mlogWarning[2m > [22mshould log warning with context
[31m[1mAssertionError[22m: expected "warn" to be called at least once[39m
[36m [2m‚ùØ[22m tests/web/error-logger.test.ts:[2m151:27[22m[39m
    [90m149| [39m      errorLogger[33m.[39m[34mlogWarning[39m([32m"Test warning"[39m[33m,[39m { page[33m:[39m [32m"/test"[39m })[33m;[39m
    [90m150| [39m
    [90m151| [39m      [34mexpect[39m(consoleWarn)[33m.[39m[34mtoHaveBeenCalled[39m()[33m;[39m
    [90m   | [39m                          [31m^[39m
    [90m152| [39m      [35mconst[39m call [33m=[39m consoleWarn[33m.[39mmock[33m.[39mcalls[[34m0[39m][33m;[39m
    [90m153| [39m      [34mexpect[39m(call[[34m0[39m])[33m.[39m[34mtoContain[39m([32m"Warning logged:"[39m)[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[44/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/web/error-logger.test.ts[2m > [22mErrorLogger[2m > [22mlogWarning[2m > [22mshould include context in warning
[31m[1mTypeError[22m: Cannot read properties of undefined (reading '1')[39m
[36m [2m‚ùØ[22m tests/web/error-logger.test.ts:[2m163:14[22m[39m
    [90m161| [39m
    [90m162| [39m      [35mconst[39m call [33m=[39m consoleWarn[33m.[39mmock[33m.[39mcalls[[34m0[39m][33m;[39m
    [90m163| [39m      [34mexpect[39m(call[[34m1[39m][33m.[39mcontext[33m.[39muserId)[33m.[39m[34mtoBe[39m([32m"user-123"[39m)[33m;[39m
    [90m   | [39m             [31m^[39m
    [90m164| [39m
    [90m165| [39m      consoleWarn[33m.[39m[34mmockRestore[39m()[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[45/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/web/storage.test.ts[2m > [22mcreateSafeStorage[2m > [22msetItem[2m > [22mshould store value successfully
[31m[1mAssertionError[22m: expected "vi.fn()" to be called with arguments: [ 'test', '{"key": "value"}' ][90m

Number of calls: [1m0[22m
[31m[39m
[36m [2m‚ùØ[22m tests/web/storage.test.ts:[2m150:27[22m[39m
    [90m148| [39m      [35mconst[39m storage [33m=[39m [34mcreateSafeStorage[39m()[33m;[39m
    [90m149| [39m      storage[33m.[39m[34msetItem[39m([32m"test"[39m[33m,[39m [32m'{"key": "value"}'[39m)[33m;[39m
    [90m150| [39m      expect(mockSetItem).toHaveBeenCalledWith("test", '{"key": "value‚Ä¶
    [90m   | [39m                          [31m^[39m
    [90m151| [39m      [34mexpect[39m(mockLocalStorage[[32m"test"[39m])[33m.[39m[34mtoBe[39m([32m'{"key": "value"}'[39m)[33m;[39m
    [90m152| [39m    })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[46/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/web/storage.test.ts[2m > [22mcreateSafeStorage[2m > [22msetItem[2m > [22mshould throw StorageError on quota exceeded
[31m[1mAssertionError[22m: expected function to throw an error, but it didn't[39m
[36m [2m‚ùØ[22m tests/web/storage.test.ts:[2m188:54[22m[39m
    [90m186| [39m
    [90m187| [39m      [35mconst[39m storage [33m=[39m [34mcreateSafeStorage[39m()[33m;[39m
    [90m188| [39m      expect(() => storage.setItem("test", "value")).toThrow(StorageEr‚Ä¶
    [90m   | [39m                                                     [31m^[39m
    [90m189| [39m      expect(() => storage.setItem("test", "value")).toThrow("quota ex‚Ä¶
    [90m190| [39m    })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[47/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/web/storage.test.ts[2m > [22mcreateSafeStorage[2m > [22msetItem[2m > [22mshould throw StorageError on security error
[31m[1mAssertionError[22m: expected function to throw an error, but it didn't[39m
[36m [2m‚ùØ[22m tests/web/storage.test.ts:[2m210:54[22m[39m
    [90m208| [39m
    [90m209| [39m      [35mconst[39m storage [33m=[39m [34mcreateSafeStorage[39m()[33m;[39m
    [90m210| [39m      expect(() => storage.setItem("test", "value")).toThrow(StorageEr‚Ä¶
    [90m   | [39m                                                     [31m^[39m
    [90m211| [39m      expect(() => storage.setItem("test", "value")).toThrow("disabled‚Ä¶
    [90m212| [39m    })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[48/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/web/submission.test.ts[2m > [22msubmission utilities[2m > [22mmergeQuestionTextIntoResults[2m > [22mshould create questionTexts when it doesn't exist
[31m[1mAssertionError[22m: expected undefined to deeply equal { 'answer-1': 'What is your opinion?' }[39m

[32m- Expected:[39m 
{
  "answer-1": "What is your opinion?",
}

[31m+ Received:[39m 
undefined

[36m [2m‚ùØ[22m tests/web/submission.test.ts:[2m57:42[22m[39m
    [90m 55| [39m      }[33m;[39m
    [90m 56| [39m      const merged = mergeQuestionTextIntoResults(results, "What is yo‚Ä¶
    [90m 57| [39m      [34mexpect[39m(merged[33m.[39mmeta[33m?.[39mquestionTexts)[33m.[39m[34mtoEqual[39m({
    [90m   | [39m                                         [31m^[39m
    [90m 58| [39m        [32m"answer-1"[39m[33m:[39m [32m"What is your opinion?"[39m[33m,[39m
    [90m 59| [39m      })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[49/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/web/submission.test.ts[2m > [22msubmission utilities[2m > [22mmergeQuestionTextIntoResults[2m > [22mshould add questionText to existing questionTexts
[31m[1mAssertionError[22m: expected { 'answer-2': 'Another question' } to deeply equal { Object (answer-2, answer-1) }[39m

[32m- Expected[39m
[31m+ Received[39m

[2m  {[22m
[32m-   "answer-1": "What is your opinion?",[39m
[2m    "answer-2": "Another question",[22m
[2m  }[22m

[36m [2m‚ùØ[22m tests/web/submission.test.ts:[2m73:42[22m[39m
    [90m 71| [39m      }[33m;[39m
    [90m 72| [39m      const merged = mergeQuestionTextIntoResults(results, "What is yo‚Ä¶
    [90m 73| [39m      [34mexpect[39m(merged[33m.[39mmeta[33m?.[39mquestionTexts)[33m.[39m[34mtoEqual[39m({
    [90m   | [39m                                         [31m^[39m
    [90m 74| [39m        [32m"answer-2"[39m[33m:[39m [32m"Another question"[39m[33m,[39m
    [90m 75| [39m        [32m"answer-1"[39m[33m:[39m [32m"What is your opinion?"[39m[33m,[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[50/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/shared/retry.test.ts[2m > [22mretryWithBackoff[2m > [22mshould retry on failure and succeed
[31m[1mAssertionError[22m: expected "vi.fn()" to be called 2 times, but got 1 times[39m
[36m [2m‚ùØ[22m tests/shared/retry.test.ts:[2m38:16[22m[39m
    [90m 36| [39m    [35mconst[39m result [33m=[39m [35mawait[39m promise[33m;[39m
    [90m 37| [39m    [34mexpect[39m(result)[33m.[39m[34mtoBe[39m([32m"success"[39m)[33m;[39m
    [90m 38| [39m    [34mexpect[39m(fn)[33m.[39m[34mtoHaveBeenCalledTimes[39m([34m2[39m)[33m;[39m
    [90m   | [39m               [31m^[39m
    [90m 39| [39m  })[33m;[39m
    [90m 40| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[51/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/shared/retry.test.ts[2m > [22mretryWithBackoff[2m > [22mshould retry up to maxAttempts times
[31m[1mAssertionError[22m: expected "vi.fn()" to be called 3 times, but got 1 times[39m
[36m [2m‚ùØ[22m tests/shared/retry.test.ts:[2m55:18[22m[39m
    [90m 53| [39m      [34mexpect[39m(error)[33m.[39m[34mtoBeInstanceOf[39m([33mError[39m)[33m;[39m
    [90m 54| [39m      [34mexpect[39m((error [35mas[39m [33mError[39m)[33m.[39mmessage)[33m.[39m[34mtoBe[39m([32m"Always fails"[39m)[33m;[39m
    [90m 55| [39m      [34mexpect[39m(fn)[33m.[39m[34mtoHaveBeenCalledTimes[39m([34m3[39m)[33m;[39m
    [90m   | [39m                 [31m^[39m
    [90m 56| [39m    }
    [90m 57| [39m  })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[52/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/shared/retry.test.ts[2m > [22mretryWithBackoff[2m > [22mshould use exponential backoff
[31m[1mAssertionError[22m: expected "vi.fn()" to be called 3 times, but got 1 times[39m
[36m [2m‚ùØ[22m tests/shared/retry.test.ts:[2m74:18[22m[39m
    [90m 72| [39m      [34mexpect[39m((error [35mas[39m [33mError[39m)[33m.[39mmessage)[33m.[39m[34mtoBe[39m([32m"Fail"[39m)[33m;[39m
    [90m 73| [39m      [90m// Should have called function 3 times (initial + 2 retries)[39m
    [90m 74| [39m      [34mexpect[39m(fn)[33m.[39m[34mtoHaveBeenCalledTimes[39m([34m3[39m)[33m;[39m
    [90m   | [39m                 [31m^[39m
    [90m 75| [39m    }
    [90m 76| [39m  })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[53/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/shared/retry.test.ts[2m > [22mretryWithBackoff[2m > [22mshould respect maxDelayMs
[31m[1mError[22m: Test timed out in 30000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".[39m
[36m [2m‚ùØ[22m tests/shared/retry.test.ts:[2m78:3[22m[39m
    [90m 76| [39m  })[33m;[39m
    [90m 77| [39m
    [90m 78| [39m  [34mit[39m([32m"should respect maxDelayMs"[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m   | [39m  [31m^[39m
    [90m 79| [39m    [35mconst[39m fn [33m=[39m vi[33m.[39m[34mfn[39m()[33m.[39m[34mmockRejectedValue[39m([35mnew[39m [33mError[39m([32m"Fail"[39m))[33m;[39m
    [90m 80| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[54/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/shared/retry.test.ts[2m > [22mretryWithBackoff[2m > [22mshould retry if shouldRetry returns true
[31m[1mAssertionError[22m: expected "vi.fn()" to be called 2 times, but got 0 times[39m
[36m [2m‚ùØ[22m tests/shared/retry.test.ts:[2m127:16[22m[39m
    [90m125| [39m    [35mconst[39m result [33m=[39m [35mawait[39m promise[33m;[39m
    [90m126| [39m    [34mexpect[39m(result)[33m.[39m[34mtoBe[39m([32m"success"[39m)[33m;[39m
    [90m127| [39m    [34mexpect[39m(fn)[33m.[39m[34mtoHaveBeenCalledTimes[39m([34m2[39m)[33m;[39m
    [90m   | [39m               [31m^[39m
    [90m128| [39m    [34mexpect[39m(shouldRetry)[33m.[39m[34mtoHaveBeenCalledWith[39m(error)[33m;[39m
    [90m129| [39m  })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[55/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/shared/retry.test.ts[2m > [22mretryWithBackoff[2m > [22mshould retry non-4xx errors by default
[31m[1mAssertionError[22m: expected "vi.fn()" to be called 2 times, but got 0 times[39m
[36m [2m‚ùØ[22m tests/shared/retry.test.ts:[2m152:16[22m[39m
    [90m150| [39m    [35mconst[39m result [33m=[39m [35mawait[39m promise[33m;[39m
    [90m151| [39m    [34mexpect[39m(result)[33m.[39m[34mtoBe[39m([32m"success"[39m)[33m;[39m
    [90m152| [39m    [34mexpect[39m(fn)[33m.[39m[34mtoHaveBeenCalledTimes[39m([34m2[39m)[33m;[39m
    [90m   | [39m               [31m^[39m
    [90m153| [39m  })[33m;[39m
    [90m154| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[56/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/shared/retry.test.ts[2m > [22mretryWithBackoff[2m > [22mshould handle errors that are not Error instances
[31m[1mAssertionError[22m: expected "vi.fn()" to be called 2 times, but got 0 times[39m
[36m [2m‚ùØ[22m tests/shared/retry.test.ts:[2m169:18[22m[39m
    [90m167| [39m      [34mexpect[39m(error)[33m.[39m[34mtoBeInstanceOf[39m([33mError[39m)[33m;[39m
    [90m168| [39m      [34mexpect[39m((error [35mas[39m [33mError[39m)[33m.[39mmessage)[33m.[39m[34mtoBe[39m([32m"string error"[39m)[33m;[39m
    [90m169| [39m      [34mexpect[39m(fn)[33m.[39m[34mtoHaveBeenCalledTimes[39m([34m2[39m)[33m;[39m
    [90m   | [39m                 [31m^[39m
    [90m170| [39m    }
    [90m171| [39m  })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[57/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/shared/retry.test.ts[2m > [22mretryWithBackoff[2m > [22mshould use default maxAttempts of 3
[31m[1mAssertionError[22m: expected "vi.fn()" to be called 3 times, but got 1 times[39m
[36m [2m‚ùØ[22m tests/shared/retry.test.ts:[2m187:18[22m[39m
    [90m185| [39m      [34mexpect[39m(error)[33m.[39m[34mtoBeInstanceOf[39m([33mError[39m)[33m;[39m
    [90m186| [39m      [34mexpect[39m((error [35mas[39m [33mError[39m)[33m.[39mmessage)[33m.[39m[34mtoBe[39m([32m"Fail"[39m)[33m;[39m
    [90m187| [39m      [34mexpect[39m(fn)[33m.[39m[34mtoHaveBeenCalledTimes[39m([34m3[39m)[33m;[39m
    [90m   | [39m                 [31m^[39m
    [90m188| [39m    }
    [90m189| [39m  })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[58/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/shared/retry.test.ts[2m > [22mretryWithBackoff[2m > [22mshould throw last error after all retries exhausted
[31m[1mAssertionError[22m: expected "vi.fn()" to be called 3 times, but got 1 times[39m
[36m [2m‚ùØ[22m tests/shared/retry.test.ts:[2m221:18[22m[39m
    [90m219| [39m      [34mexpect[39m(error)[33m.[39m[34mtoBeInstanceOf[39m([33mError[39m)[33m;[39m
    [90m220| [39m      [34mexpect[39m((error [35mas[39m [33mError[39m)[33m.[39mmessage)[33m.[39m[34mtoBe[39m([32m"Final error"[39m)[33m;[39m
    [90m221| [39m      [34mexpect[39m(fn)[33m.[39m[34mtoHaveBeenCalledTimes[39m([34m3[39m)[33m;[39m
    [90m   | [39m                 [31m^[39m
    [90m222| [39m    }
    [90m223| [39m  })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[59/60]‚éØ[22m[39m

[41m[1m FAIL [22m[49m tests/shared/retry.test.ts[2m > [22mretryWithBackoff[2m > [22mshould handle promise rejection correctly
[31m[1mAssertionError[22m: expected "vi.fn()" to be called 2 times, but got 0 times[39m
[36m [2m‚ùØ[22m tests/shared/retry.test.ts:[2m239:18[22m[39m
    [90m237| [39m      [34mexpect[39m(error)[33m.[39m[34mtoBeInstanceOf[39m([33mError[39m)[33m;[39m
    [90m238| [39m      [34mexpect[39m((error [35mas[39m [33mError[39m)[33m.[39mmessage)[33m.[39m[34mtoBe[39m([32m"Rejected"[39m)[33m;[39m
    [90m239| [39m      [34mexpect[39m(fn)[33m.[39m[34mtoHaveBeenCalledTimes[39m([34m2[39m)[33m;[39m
    [90m   | [39m                 [31m^[39m
    [90m240| [39m    }
    [90m241| [39m  })[33m;[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[60/60]‚éØ[22m[39m

[31m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[39m[1m[41m Unhandled Errors [49m[22m[31m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[39m
[31m[1m
Vitest caught 3 unhandled errors during the test run.
This might cause false positive tests. Resolve unhandled errors to make sure your tests are not affected.[22m[39m

[31m‚éØ‚éØ‚éØ‚éØ[39m[1m[41m Unhandled Rejection [49m[22m[31m‚éØ‚éØ‚éØ‚éØ‚éØ[39m
[31m[1mError[22m: string error[39m
[36m [2m‚ùØ[22m retryWithBackoff packages/shared/ts/retry.ts:[2m54:52[22m[39m
    [90m 52| [39m      [35mreturn[39m [35mawait[39m [34mfn[39m()[33m;[39m
    [90m 53| [39m    } [35mcatch[39m (error) {
    [90m 54| [39m      lastError = error instanceof Error ? error : new Error(String(er‚Ä¶
    [90m   | [39m                                                   [31m^[39m
    [90m 55| [39m
    [90m 56| [39m      [35mif[39m ([33m![39m[34mshouldRetry[39m(error)) {

[31mThis error originated in "[1mtests/shared/retry.test.ts[22m" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.[39m
[31mThe latest test that might've caused the error is "[1mshould use default maxAttempts of 3[22m". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- If the error occurred after the test had been completed, this was the last documented test before it was thrown.[39m

[31m‚éØ‚éØ‚éØ‚éØ[39m[1m[41m Unhandled Rejection [49m[22m[31m‚éØ‚éØ‚éØ‚éØ‚éØ[39m
[31m[1mError[22m: Rejected[39m
[36m [2m‚ùØ[22m tests/shared/retry.test.ts:[2m226:64[22m[39m
    [90m224| [39m
    [90m225| [39m  [34mit[39m([32m"should handle promise rejection correctly"[39m[33m,[39m [35masync[39m () [33m=>[39m {
    [90m226| [39m    const fn = vi.fn().mockImplementation(() => Promise.reject(new Err‚Ä¶
    [90m   | [39m                                                               [31m^[39m
    [90m227| [39m
    [90m228| [39m    const promise = retryWithBackoff(fn, { maxAttempts: 2, baseDelayMs‚Ä¶
[90m [2m‚ùØ[22m Mock node_modules/@vitest/spy/dist/index.js:[2m280:34[22m[39m
[90m [2m‚ùØ[22m retryWithBackoff packages/shared/ts/retry.ts:[2m52:20[22m[39m

[31mThis error originated in "[1mtests/shared/retry.test.ts[22m" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.[39m
[31mThe latest test that might've caused the error is "[1mshould handle promise rejection correctly[22m". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- If the error occurred after the test had been completed, this was the last documented test before it was thrown.[39m

[31m‚éØ‚éØ‚éØ‚éØ[39m[1m[41m Unhandled Rejection [49m[22m[31m‚éØ‚éØ‚éØ‚éØ‚éØ[39m
[31m[1mError[22m: Final error[39m
[36m [2m‚ùØ[22m tests/shared/retry.test.ts:[2m203:23[22m[39m
    [90m201| [39m
    [90m202| [39m  it("should throw last error after all retries exhausted", async () =‚Ä¶
    [90m203| [39m    [35mconst[39m lastError [33m=[39m [35mnew[39m [33mError[39m([32m"Final error"[39m)[33m;[39m
    [90m   | [39m                      [31m^[39m
    [90m204| [39m    [35mconst[39m fn [33m=[39m vi
    [90m205| [39m      [33m.[39m[34mfn[39m()
[90m [2m‚ùØ[22m node_modules/@vitest/runner/dist/index.js:[2m157:11[22m[39m
[90m [2m‚ùØ[22m node_modules/@vitest/runner/dist/index.js:[2m753:26[22m[39m
[90m [2m‚ùØ[22m node_modules/@vitest/runner/dist/index.js:[2m1636:20[22m[39m
[90m [2m‚ùØ[22m runWithTimeout node_modules/@vitest/runner/dist/index.js:[2m1602:10[22m[39m
[90m [2m‚ùØ[22m runTest node_modules/@vitest/runner/dist/index.js:[2m1309:12[22m[39m
[90m [2m‚ùØ[22m runNextTicks node:internal/process/task_queues:[2m64:5[22m[39m
[90m [2m‚ùØ[22m processImmediate node:internal/timers:[2m472:9[22m[39m

[31mThis error originated in "[1mtests/shared/retry.test.ts[22m" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.[39m
[31m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[39m


[2m Test Files [22m [1m[31m11 failed[39m[22m[2m | [22m[1m[32m22 passed[39m[22m[90m (33)[39m
[2m      Tests [22m [1m[31m60 failed[39m[22m[2m | [22m[1m[32m437 passed[39m[22m[90m (497)[39m
[2m     Errors [22m [1m[31m3 errors[39m[22m
[2m   Start at [22m 15:38:26
[2m   Duration [22m 35.66s[2m (transform 1.28s, setup 448ms, collect 1.63s, tests 65.95s, environment 2ms, prepare 291ms)[22m

